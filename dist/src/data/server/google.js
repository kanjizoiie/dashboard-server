"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}}(),_googleapis=require("googleapis"),_googleapis2=_interopRequireDefault(_googleapis),_path=require("path"),_path2=_interopRequireDefault(_path),_fs=require("fs"),_fs2=_interopRequireDefault(_fs);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var tokens=require("../../json/google.json"),googleOAuth2=require("../../json/googleAccount.json"),Google=function(){function e(){return _classCallCheck(this,e),this.instance||(this.instance=this),this.OAuth2=_googleapis2.default.auth.OAuth2,this.analytics=_googleapis2.default.analyticsreporting("v4"),this.oauth2Client=new this.OAuth2(googleOAuth2.installed.client_id,googleOAuth2.installed.client_secret,googleOAuth2.installed.redirect_uris[1]),this.oauth2Client.credentials=tokens,this.url=this.oauth2Client.generateAuthUrl({scope:"https://www.googleapis.com/auth/analytics.readonly"}),this.instance}return _createClass(e,[{key:"batchGet",value:function(e){var t=this;return new Promise(function(n,o){try{t.analytics.reports.batchGet({resource:{reportRequests:e},auth:t.oauth2Client},function(e,t){null!==e?o(e):n(t)})}catch(e){o(e)}})}},{key:"authURL",value:function(){return this.url}},{key:"auth",value:function(e){var t=this;new Promise(function(n,o){t.oauth2Client.getToken(e,function(e,t){console.log(t),null!==t&&n(t),null!==e&&o(e)})}).then(function(e){t.oauth2Client.credentials=e,_fs2.default.writeFile(__dirname+"src/json/google.json",JSON.stringify(e,null,1),{flag:_fs2.default.O_TRUNC},function(e){e?console.log("Token writing error: "+e):console.log("Saved the new access token!")})}).catch(function(e){return console.log(e)})}}]),e}();Google.instance=null,exports.default=Google;