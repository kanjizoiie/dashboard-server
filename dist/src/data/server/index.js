"use strict";var _express=require("express"),_express2=_interopRequireDefault(_express),_google=require("./google"),_google2=_interopRequireDefault(_google),_data=require("./data"),_data2=_interopRequireDefault(_data);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var router=_express2.default.Router(),data=new _data2.default,google=new _google2.default,code=void 0;router.get("/auth",function(e,t,r){void 0===e.query.code?t.redirect(google.url):(code=e.query.code,google.auth(code))}),router.get("/",function(e,t,r){Promise.all([data.getServersArray(),data.getRecentAlerts()]).then(function(e){console.log(e),t.json(e)})}),router.get("/:id",function(e,t,r){Promise.all([data.getUptimeThisMonth(e.params.id),data.getAlerts(e.params.id),data.getHostName(e.params.id),data.getUp(e.params.id),data.getUsers(e.params.id)]).then(function(e){try{t.json({uptime:e[0],alerts:e[1],hostname:e[2],up:e[3],users:e[4]})}catch(e){t.send("There was no server at this index")}})}),router.get("/:id/graph",function(e,t,r){data.getGraphs(e.params.id).then(function(e){t.json(e)})}),module.exports=router;